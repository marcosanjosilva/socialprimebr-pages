<!doctype html><html lang="pt-BR"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Calendário — SocialPrimeBR</title>
<link rel="icon" href="img/favicon.svg"/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/theme.css"/>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/config.js"></script>
</head><body>
<canvas id="bg"></canvas>

<header>
  <div class="nav">
    <div class="brand" onclick="location.href='dashboard.html'"><svg class="bolt" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M10 2L3 13h6l-2 9 9-13h-6l2-7z" fill="url(#g)"/>
<defs><linearGradient id="g" x1="0" y1="0" x2="24" y2="24">
<stop stop-color="#7a5cff"/><stop offset="1" stop-color="#6ce1ff"/></linearGradient></defs></svg><span>SocialPrimeBR</span></div>
    <div class="spacer"></div>
    <nav class="actions">
      <a class="btn" href="calendar.html">Calendário</a>
      <a class="btn" href="schedule.html">Agendar</a>
      <a class="btn" href="workspaces.html">Trocar Perfil</a>
      <a class="btn" href="settings.html">Configurações</a>
      <button class="btn" id="btnLogout">Sair</button>
    </nav>
  </div>
</header>
<div class="container">
<div class="card">
  <div class="actions"><button class="btn" id="prev">◀</button><strong id="label" style="padding:0 8px"></strong><button class="btn" id="next">▶</button></div>
  <hr class="sep"/>
  <div id="cal" class="calendar"></div>
</div>
<div class="card">
  <h2>Agendamentos do mês</h2>
  <table class="table" id="tbl">
    <thead><tr><th>Data</th><th>Status</th><th>Conteúdo</th><th>Canais</th></tr></thead>
    <tbody></tbody>
  </table>
</div>
<script>
// Demo calendar data (estático). Integração real virá da tabela 'schedules' por workspace.
let current = new Date(); const calEl=document.getElementById('cal'); const label=document.getElementById('label');
const demo=[
  {date:'2025-08-03',title:'Reels — Produto X',channels:'IG Reels',status:'Agendado'},
  {date:'2025-08-03',title:'Story — Bastidores',channels:'IG Story',status:'Agendado'},
  {date:'2025-08-03',title:'Feed — Promoção',channels:'IG Feed',status:'Agendado'},
  {date:'2025-08-12',title:'YouTube Shorts',channels:'YT Shorts',status:'Agendado'},
  {date:'2025-08-20',title:'TikTok teaser',channels:'TikTok',status:'Agendado'},
  {date:'2025-08-28',title:'Post Blog',channels:'Google',status:'Agendado'}
];
function render(){
  const y=current.getFullYear(), m=current.getMonth(); label.textContent=current.toLocaleDateString('pt-BR',{month:'long',year:'numeric'});
  calEl.innerHTML=''; const first=new Date(y,m,1), start=(first.getDay()+6)%7; // start on Monday
  const days=new Date(y,m+1,0).getDate();
  for(let i=0;i<start;i++){ const d=document.createElement('div'); d.className='day'; calEl.appendChild(d); }
  for(let day=1;day<=days;day++){ const cel=document.createElement('div'); cel.className='day'; const key=`${y}-${String(m+1).padStart(2,'0')}-${String(day).padStart(2,'0')}`; cel.innerHTML=`<div class="d">${day}</div>`;
    const evs=demo.filter(x=>x.date===key).slice(0,3);
    evs.forEach(e=>{ const ev=document.createElement('div'); ev.className='event'; ev.textContent=e.title; cel.appendChild(ev) });
    if(demo.filter(x=>x.date===key).length>3){ const ev=document.createElement('div'); ev.className='event'; ev.textContent='… mostrar mais'; cel.appendChild(ev)}
    cel.addEventListener('click',()=>{
      const items=demo.filter(x=>x.date===key); alert(items.length? items.map(i=>`• ${i.title} — ${i.channels}`).join('\n') : 'Sem agendamentos.');
    });
    calEl.appendChild(cel);
  }
  // tabela
  const tbody=document.querySelector('#tbl tbody'); tbody.innerHTML='';
  demo.filter(x=> new Date(x.date).getMonth()===m).forEach(i=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${new Date(i.date).toLocaleDateString('pt-BR')}</td><td>${i.status}</td><td>${i.title}</td><td>${i.channels}</td>`;
    tbody.appendChild(tr);
  });
}
document.getElementById('prev').onclick=()=>{ current.setMonth(current.getMonth()-1); render(); }
document.getElementById('next').onclick=()=>{ current.setMonth(current.getMonth()+1); render(); }
render();
</script>
</div>
<footer>© 2025 SocialPrimeBR — Todos os direitos reservados.</footer>
<script src="assets/background.js"></script>
<script>
const supabase = window.supabase.createClient(window.SP_URL, window.SP_ANON);

// Protect pages that need auth
(async()=>{
  const needAuth = !/index\.html|termos|politica|login\.html|cadastro\.html|recuperar\.html/.test(location.pathname);
  const { data: { session } } = await supabase.auth.getSession();
  if(needAuth && !session){ location.href='login.html'; }
})();

// Sair
document.getElementById('btnLogout')?.addEventListener('click', async ()=>{
  try{
    await supabase.auth.signOut();
  }finally{
    localStorage.clear();
    location.href='login.html';
  }
});

</script>
</body></html>